<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>产品应用地图</title>
  <style>
    html, body { height: 100%; margin: 0; }
    /* 用 100vh 避免父容器高度为 0 导致图表不显示 */
    #chart { width: 100%; height: 100vh; }
  </style>
</head>
<body>
  <div id="chart"></div>

<script src="./vendor/echarts.min.js?v=1"></script>
<script src="./vendor/china.js?v=1"></script>

  <!-- 你的数据：直接写在页面里，绝不会有路径/跨域问题 -->
  <script>
    const APP_DATA = {
      "广东": { "渠道商": "无", "产品类别": "OMS、TMS", "应用规模": "规模应用" },
      "云南": { "渠道商": "无", "产品类别": "OMS",      "应用规模": "规模应用" },
      "浙江": { "渠道商": "无", "产品类别": "OMS",      "应用规模": "试点应用" },
      "新疆": { "渠道商": "无", "产品类别": "TMS",      "应用规模": "试点应用" }
    };
  </script>

  <!-- 画图逻辑：不 fetch，直接用上面的 APP_DATA -->
  <script>
    (function () {
      function start() {
        var el = document.getElementById('chart');
        if (!el) return;

        var chart = echarts.init(el);

        var seriesData = Object.keys(APP_DATA).map(function (p) {
          return { name: p, value: 1, info: APP_DATA[p] };
        });

        var option = {
          tooltip: {
            trigger: 'item',
            formatter: function (params) {
              var info = params.data && params.data.info;
              if (info) {
                function get(k){ return (info[k] != null && info[k] !== '') ? info[k] : '—'; }
                return [
                  params.name,
                  '渠道商：' + get('渠道商'),
                  '产品类别：' + get('产品类别'),
                  '应用规模：' + get('应用规模')
                ].join('<br/>');
              }
              return params.name + '<br/>无数据';
            }
          },
          visualMap: { show: false, min: 0, max: 1, inRange: { color: ['#e0f3ff', '#006edd'] } },
          series: [{
            name: '应用区域',
            type: 'map',
            map: 'china',
            roam: true,
            label: { show: true, fontSize: 10 },
            data: seriesData
          }]
        };

        chart.setOption(option);
        window.addEventListener('resize', function () { chart.resize(); });
      }

      // 等 DOM 就绪后再初始化
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', start);
      } else {
        start();
      }
    })();
  </script>
</body>
</html>
